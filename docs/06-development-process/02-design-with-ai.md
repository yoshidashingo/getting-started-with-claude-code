# AIã¨è¨­è¨ˆ

Claude Codeã‚’æ´»ç”¨ã—ãŸè¨­è¨ˆãƒ—ãƒ­ã‚»ã‚¹ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ±ºå®šã®æ”¯æ´æ–¹æ³•ã‚’å­¦ç¿’ã§ãã¾ã™ã€‚

## AIã‚’æ´»ç”¨ã—ãŸè¨­è¨ˆã¨ã¯

å¾“æ¥ã®è¨­è¨ˆãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€å€‹äººã®çµŒé¨“ã¨çŸ¥è­˜ã«ä¾å­˜ã—ãŸè¨­è¨ˆåˆ¤æ–­ãŒå¤šãã€ä¸€è²«æ€§ã‚„æœ€é©æ€§ã®ç¢ºä¿ãŒå›°é›£ã§ã—ãŸã€‚AIæ´»ç”¨è¨­è¨ˆã§ã¯ã€Claude Codeã¨ã®å¯¾è©±ã‚’é€šã˜ã¦ã€ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«åŸºã¥ã„ãŸè¨­è¨ˆæ±ºå®šã‚’åŠ¹ç‡çš„ã«è¡Œã„ã¾ã™ã€‚

### AIæ´»ç”¨è¨­è¨ˆã®åˆ©ç‚¹

- **çŸ¥è­˜ã®æ´»ç”¨**: è±Šå¯Œãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®é©ç”¨
- **ä¸€è²«æ€§**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§ã®è¨­è¨ˆæ–¹é‡ã®çµ±ä¸€
- **åŠ¹ç‡æ€§**: è¨­è¨ˆæ¤œè¨æ™‚é–“ã®çŸ­ç¸®ã¨å“è³ªå‘ä¸Š
- **å­¦ç¿’åŠ¹æœ**: è¨­è¨ˆã®æ ¹æ‹ ã¨ç†ç”±ã®ç†è§£ä¿ƒé€²

## è¨­è¨ˆãƒ—ãƒ­ã‚»ã‚¹

### ãƒ•ã‚§ãƒ¼ã‚º1: ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

#### ã‚¹ãƒ†ãƒƒãƒ—1: ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆã®æ¤œè¨

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹:**
```
ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆã‚’æ”¯æ´ã—ã¦ãã ã•ã„ã€‚

è¦ä»¶æ¦‚è¦:
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: 50åï¼ˆåŒæ™‚æ¥ç¶š20åï¼‰
- ä¸»è¦æ©Ÿèƒ½: ã‚¿ã‚¹ã‚¯ç®¡ç†ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å…±æœ‰ã€é€²æ—å¯è¦–åŒ–
- éæ©Ÿèƒ½è¦ä»¶: ãƒ¬ã‚¹ãƒãƒ³ã‚¹3ç§’ä»¥å†…ã€å¯ç”¨æ€§99.5%
- åˆ¶ç´„: æ—¢å­˜ADé€£æºã€ç¤¾å†…ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒãƒªã‚·ãƒ¼éµå®ˆ

ä»¥ä¸‹ã®è¦³ç‚¹ã§è¨­è¨ˆã‚’ææ¡ˆã—ã¦ãã ã•ã„:
1. å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³
2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸æŠ
3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ–¹é‡
4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
5. æ‹¡å¼µæ€§ã¸ã®é…æ…®
```

**Claude Codeã‹ã‚‰ã®ææ¡ˆä¾‹:**
```
# ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

## 1. å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³

### æ¨å¥¨ãƒ‘ã‚¿ãƒ¼ãƒ³: ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ + MVC

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Presentation Layer        â”‚
â”‚  (React SPA + WebSocket Client)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Application Layer         â”‚
â”‚     (Node.js + Express + Socket.io) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            Business Layer           â”‚
â”‚        (Service Classes)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Data Access Layer           â”‚
â”‚    (Repository Pattern + ORM)       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Database Layer            â”‚
â”‚         (PostgreSQL)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é¸æŠç†ç”±:**
- å°ã€œä¸­è¦æ¨¡ã‚·ã‚¹ãƒ†ãƒ ã«é©ã—ã¦ã„ã‚‹
- é–‹ç™ºãƒ»ä¿å®ˆãŒå®¹æ˜“
- ãƒãƒ¼ãƒ é–‹ç™ºã«é©ã—ã¦ã„ã‚‹
- æ®µéšçš„ãªæ‹¡å¼µãŒå¯èƒ½

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸æŠ

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **React 18** + TypeScript
  - ç†ç”±: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã€è±Šå¯Œãªã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ 
- **Material-UI v5**
  - ç†ç”±: ä¼æ¥­å‘ã‘UIã€ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œ
- **Socket.io Client**
  - ç†ç”±: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯æ©Ÿèƒ½

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Node.js 18** + Express
  - ç†ç”±: JavaScriptçµ±ä¸€ã€é«˜ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- **Socket.io**
  - ç†ç”±: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ã€ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£
- **Prisma ORM**
  - ç†ç”±: å‹å®‰å…¨ã€ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **PostgreSQL 15**
  - ç†ç”±: ACIDæº–æ‹ ã€JSONå¯¾å¿œã€æ‹¡å¼µæ€§
- **Redis**
  - ç†ç”±: ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡

### ã‚¤ãƒ³ãƒ•ãƒ©
- **Docker** + **Docker Compose**
  - ç†ç”±: ç’°å¢ƒçµ±ä¸€ã€ãƒ‡ãƒ—ãƒ­ã‚¤ç°¡ç´ åŒ–
- **Nginx**
  - ç†ç”±: ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã€é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæ–¹é‡

### æ­£è¦åŒ–ãƒ¬ãƒ™ãƒ«: ç¬¬3æ­£è¦å½¢
- ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ç¢ºä¿
- å†—é•·æ€§ã®æ’é™¤
- ä¿å®ˆæ€§ã®å‘ä¸Š

### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ
```sql
-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    display_name VARCHAR(100) NOT NULL,
    department_id UUID REFERENCES departments(id),
    role user_role NOT NULL DEFAULT 'member',
    is_active BOOLEAN DEFAULT true,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ã‚¿ã‚¹ã‚¯ç®¡ç†
CREATE TABLE tasks (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    title VARCHAR(255) NOT NULL,
    description TEXT,
    status task_status NOT NULL DEFAULT 'todo',
    priority task_priority NOT NULL DEFAULT 'medium',
    due_date TIMESTAMP,
    assigned_to UUID REFERENCES users(id),
    created_by UUID REFERENCES users(id) NOT NULL,
    project_id UUID REFERENCES projects(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æˆ¦ç•¥
```sql
-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
CREATE INDEX idx_tasks_assigned_to ON tasks(assigned_to);
CREATE INDEX idx_tasks_status ON tasks(status);
CREATE INDEX idx_tasks_due_date ON tasks(due_date);
CREATE INDEX idx_tasks_project_id ON tasks(project_id);
```

## 4. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### èªè¨¼ãƒ»èªå¯ãƒ•ãƒ­ãƒ¼
```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³ â†’ ADèªè¨¼
2. JWT ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œï¼ˆæœ‰åŠ¹æœŸé™: 8æ™‚é–“ï¼‰
3. ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œï¼ˆæœ‰åŠ¹æœŸé™: 30æ—¥ï¼‰
4. å„APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã§JWTæ¤œè¨¼
5. æ¨©é™ãƒã‚§ãƒƒã‚¯ï¼ˆRBACï¼‰
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–
- **é€šä¿¡æš—å·åŒ–**: TLS 1.3
- **å…¥åŠ›æ¤œè¨¼**: Joi ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- **SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–**: Prisma ORMä½¿ç”¨
- **XSSå¯¾ç­–**: CSP ãƒ˜ãƒƒãƒ€ãƒ¼è¨­å®š
- **CSRFå¯¾ç­–**: SameSite Cookie

## 5. æ‹¡å¼µæ€§ã¸ã®é…æ…®

### æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°å¯¾å¿œ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Load        â”‚    â”‚ Load        â”‚
â”‚ Balancer    â”‚    â”‚ Balancer    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ App Server  â”‚    â”‚ App Server  â”‚
â”‚ Instance 1  â”‚    â”‚ Instance 2  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Database    â”‚
    â”‚ Cluster     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ç§»è¡Œãƒ‘ã‚¹
1. **Phase 1**: ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯æ§‹æˆ
2. **Phase 2**: æ©Ÿèƒ½åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†é›¢
3. **Phase 3**: ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–

ã“ã®è¨­è¨ˆã«ã‚ˆã‚Šã€ç¾åœ¨ã®è¦ä»¶ã‚’æº€ãŸã—ãªãŒã‚‰ã€
å°†æ¥ã®æ‹¡å¼µã«ã‚‚å¯¾å¿œã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ ãŒæ§‹ç¯‰ã§ãã¾ã™ã€‚
```

#### ã‚¹ãƒ†ãƒƒãƒ—2: è©³ç´°è¨­è¨ˆã®æ¤œè¨

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹:**
```
ææ¡ˆã•ã‚ŒãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’åŸºã«ã€ä»¥ä¸‹ã®è©³ç´°è¨­è¨ˆã‚’è¡Œã£ã¦ãã ã•ã„ï¼š

1. APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ
2. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´°è¨­è¨ˆ
3. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡è¨­è¨ˆ
4. çŠ¶æ…‹ç®¡ç†è¨­è¨ˆï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ

RESTful APIã®åŸå‰‡ã«å¾“ã„ã€OpenAPIä»•æ§˜ã‚‚å«ã‚ã¦ãã ã•ã„ã€‚
```

**Claude Codeã®è©³ç´°è¨­è¨ˆä¾‹:**
```
# è©³ç´°è¨­è¨ˆä»•æ§˜

## 1. API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¨­è¨ˆ

### RESTful API è¨­è¨ˆåŸå‰‡
- ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹ã®URLè¨­è¨ˆ
- HTTPãƒ¡ã‚½ãƒƒãƒ‰ã®é©åˆ‡ãªä½¿ç”¨
- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã®çµ±ä¸€
- ä¸€è²«ã—ãŸãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼

### ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§

#### èªè¨¼é–¢é€£
```
POST   /api/auth/login          # ãƒ­ã‚°ã‚¤ãƒ³
POST   /api/auth/logout         # ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
POST   /api/auth/refresh        # ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°
GET    /api/auth/me             # ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
```

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†
```
GET    /api/users               # ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§å–å¾—
GET    /api/users/:id           # ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—
PUT    /api/users/:id           # ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±æ›´æ–°
GET    /api/users/:id/tasks     # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¿ã‚¹ã‚¯ä¸€è¦§
```

#### ã‚¿ã‚¹ã‚¯ç®¡ç†
```
GET    /api/tasks               # ã‚¿ã‚¹ã‚¯ä¸€è¦§å–å¾—
POST   /api/tasks               # ã‚¿ã‚¹ã‚¯ä½œæˆ
GET    /api/tasks/:id           # ç‰¹å®šã‚¿ã‚¹ã‚¯å–å¾—
PUT    /api/tasks/:id           # ã‚¿ã‚¹ã‚¯æ›´æ–°
DELETE /api/tasks/:id           # ã‚¿ã‚¹ã‚¯å‰Šé™¤
POST   /api/tasks/:id/comments  # ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
```

#### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†
```
GET    /api/projects            # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§
POST   /api/projects            # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
GET    /api/projects/:id        # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°
PUT    /api/projects/:id        # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ›´æ–°
GET    /api/projects/:id/tasks  # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¿ã‚¹ã‚¯
```

### OpenAPI ä»•æ§˜ä¾‹

```yaml
openapi: 3.0.3
info:
  title: Task Management API
  version: 1.0.0
  description: ç¤¾å†…ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ API

paths:
  /api/tasks:
    get:
      summary: ã‚¿ã‚¹ã‚¯ä¸€è¦§å–å¾—
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [todo, in_progress, done, on_hold]
        - name: assigned_to
          in: query
          schema:
            type: string
            format: uuid
        - name: page
          in: query
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        '200':
          description: æˆåŠŸ
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/Task'
                  pagination:
                    $ref: '#/components/schemas/Pagination'
                  
    post:
      summary: ã‚¿ã‚¹ã‚¯ä½œæˆ
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTaskRequest'
      responses:
        '201':
          description: ä½œæˆæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
        '400':
          description: ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    Task:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
          maxLength: 255
        description:
          type: string
        status:
          type: string
          enum: [todo, in_progress, done, on_hold]
        priority:
          type: string
          enum: [low, medium, high, urgent]
        due_date:
          type: string
          format: date-time
        assigned_to:
          $ref: '#/components/schemas/User'
        created_by:
          $ref: '#/components/schemas/User'
        project:
          $ref: '#/components/schemas/Project'
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time
      required:
        - id
        - title
        - status
        - priority
        - created_by
        - created_at
        - updated_at
```

## 2. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«è©³ç´°è¨­è¨ˆ

### ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«

```typescript
// Domain Models
export interface User {
  id: string;
  username: string;
  email: string;
  displayName: string;
  department: Department;
  role: UserRole;
  isActive: boolean;
  createdAt: Date;
  updatedAt: Date;
}

export interface Task {
  id: string;
  title: string;
  description?: string;
  status: TaskStatus;
  priority: TaskPriority;
  dueDate?: Date;
  assignedTo?: User;
  createdBy: User;
  project?: Project;
  comments: Comment[];
  attachments: Attachment[];
  createdAt: Date;
  updatedAt: Date;
}

export interface Project {
  id: string;
  name: string;
  description?: string;
  status: ProjectStatus;
  startDate?: Date;
  endDate?: Date;
  owner: User;
  members: User[];
  tasks: Task[];
  createdAt: Date;
  updatedAt: Date;
}

// Enums
export enum TaskStatus {
  TODO = 'todo',
  IN_PROGRESS = 'in_progress',
  DONE = 'done',
  ON_HOLD = 'on_hold'
}

export enum TaskPriority {
  LOW = 'low',
  MEDIUM = 'medium',
  HIGH = 'high',
  URGENT = 'urgent'
}

export enum UserRole {
  MEMBER = 'member',
  MANAGER = 'manager',
  ADMIN = 'admin'
}
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

```sql
-- éƒ¨é–€ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE departments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL,
    description TEXT,
    parent_id UUID REFERENCES departments(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    username VARCHAR(50) UNIQUE NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    display_name VARCHAR(100) NOT NULL,
    department_id UUID REFERENCES departments(id),
    role user_role NOT NULL DEFAULT 'member',
    is_active BOOLEAN DEFAULT true,
    last_login_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE projects (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    description TEXT,
    status project_status NOT NULL DEFAULT 'active',
    start_date DATE,
    end_date DATE,
    owner_id UUID REFERENCES users(id) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ã‚¿ã‚¹ã‚¯ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE tasks (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    title VARCHAR(255) NOT NULL,
    description TEXT,
    status task_status NOT NULL DEFAULT 'todo',
    priority task_priority NOT NULL DEFAULT 'medium',
    due_date TIMESTAMP,
    assigned_to UUID REFERENCES users(id),
    created_by UUID REFERENCES users(id) NOT NULL,
    project_id UUID REFERENCES projects(id),
    parent_task_id UUID REFERENCES tasks(id),
    estimated_hours INTEGER,
    actual_hours INTEGER,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ã‚³ãƒ¡ãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE comments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    task_id UUID REFERENCES tasks(id) NOT NULL,
    user_id UUID REFERENCES users(id) NOT NULL,
    content TEXT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE attachments (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    task_id UUID REFERENCES tasks(id) NOT NULL,
    filename VARCHAR(255) NOT NULL,
    original_name VARCHAR(255) NOT NULL,
    mime_type VARCHAR(100) NOT NULL,
    file_size INTEGER NOT NULL,
    uploaded_by UUID REFERENCES users(id) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ³ãƒãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE project_members (
    project_id UUID REFERENCES projects(id),
    user_id UUID REFERENCES users(id),
    role project_member_role NOT NULL DEFAULT 'member',
    joined_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (project_id, user_id)
);

-- ã‚«ã‚¹ã‚¿ãƒ å‹å®šç¾©
CREATE TYPE user_role AS ENUM ('member', 'manager', 'admin');
CREATE TYPE task_status AS ENUM ('todo', 'in_progress', 'done', 'on_hold');
CREATE TYPE task_priority AS ENUM ('low', 'medium', 'high', 'urgent');
CREATE TYPE project_status AS ENUM ('active', 'completed', 'archived');
CREATE TYPE project_member_role AS ENUM ('member', 'manager');
```

## 3. ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡è¨­è¨ˆ

### Socket.io ã‚¤ãƒ™ãƒ³ãƒˆè¨­è¨ˆ

```typescript
// Server-side Events
interface ServerToClientEvents {
  // ã‚¿ã‚¹ã‚¯é–¢é€£
  'task:created': (task: Task) => void;
  'task:updated': (task: Task) => void;
  'task:deleted': (taskId: string) => void;
  'task:assigned': (task: Task, assignee: User) => void;
  
  // ã‚³ãƒ¡ãƒ³ãƒˆé–¢é€£
  'comment:added': (comment: Comment) => void;
  
  // ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–¢é€£
  'project:updated': (project: Project) => void;
  'project:member_added': (project: Project, member: User) => void;
  
  // é€šçŸ¥é–¢é€£
  'notification:new': (notification: Notification) => void;
  
  // ã‚·ã‚¹ãƒ†ãƒ é–¢é€£
  'system:maintenance': (message: string) => void;
}

// Client-side Events
interface ClientToServerEvents {
  // æ¥ç¶šç®¡ç†
  'join:project': (projectId: string) => void;
  'leave:project': (projectId: string) => void;
  
  // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç·¨é›†
  'task:editing': (taskId: string, userId: string) => void;
  'task:stop_editing': (taskId: string, userId: string) => void;
  
  // é€šçŸ¥ç¢ºèª
  'notification:read': (notificationId: string) => void;
}
```

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³
   â†“
2. Socket.ioæ¥ç¶šç¢ºç«‹
   â†“
3. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒ ã«å‚åŠ 
   â†“
4. ã‚¿ã‚¹ã‚¯æ›´æ–°æ™‚
   â†“
5. é–¢é€£ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«é€šçŸ¥é…ä¿¡
   â†“
6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
```

## 4. çŠ¶æ…‹ç®¡ç†è¨­è¨ˆï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰

### Redux Toolkit è¨­è¨ˆ

```typescript
// Store Structure
interface RootState {
  auth: AuthState;
  tasks: TasksState;
  projects: ProjectsState;
  users: UsersState;
  notifications: NotificationsState;
  ui: UIState;
}

// Auth Slice
interface AuthState {
  user: User | null;
  token: string | null;
  isAuthenticated: boolean;
  isLoading: boolean;
  error: string | null;
}

// Tasks Slice
interface TasksState {
  items: Record<string, Task>;
  lists: {
    all: string[];
    byProject: Record<string, string[]>;
    byAssignee: Record<string, string[]>;
    byStatus: Record<TaskStatus, string[]>;
  };
  filters: TaskFilters;
  isLoading: boolean;
  error: string | null;
}

// Async Thunks
export const fetchTasks = createAsyncThunk(
  'tasks/fetchTasks',
  async (params: FetchTasksParams, { rejectWithValue }) => {
    try {
      const response = await taskAPI.getTasks(params);
      return response.data;
    } catch (error) {
      return rejectWithValue(error.response.data);
    }
  }
);

// Slice Definition
const tasksSlice = createSlice({
  name: 'tasks',
  initialState,
  reducers: {
    // Synchronous actions
    setFilter: (state, action) => {
      state.filters = { ...state.filters, ...action.payload };
    },
    clearError: (state) => {
      state.error = null;
    },
  },
  extraReducers: (builder) => {
    builder
      .addCase(fetchTasks.pending, (state) => {
        state.isLoading = true;
        state.error = null;
      })
      .addCase(fetchTasks.fulfilled, (state, action) => {
        state.isLoading = false;
        // Normalize data
        const tasks = action.payload;
        tasks.forEach(task => {
          state.items[task.id] = task;
        });
        state.lists.all = tasks.map(task => task.id);
      })
      .addCase(fetchTasks.rejected, (state, action) => {
        state.isLoading = false;
        state.error = action.payload as string;
      });
  },
});
```

## 5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­è¨ˆ

### ã‚¨ãƒ©ãƒ¼åˆ†é¡ã¨å¯¾å¿œ

```typescript
// Error Types
export enum ErrorType {
  VALIDATION = 'VALIDATION_ERROR',
  AUTHENTICATION = 'AUTHENTICATION_ERROR',
  AUTHORIZATION = 'AUTHORIZATION_ERROR',
  NOT_FOUND = 'NOT_FOUND_ERROR',
  CONFLICT = 'CONFLICT_ERROR',
  INTERNAL = 'INTERNAL_SERVER_ERROR',
  NETWORK = 'NETWORK_ERROR',
}

// Error Response Format
interface ErrorResponse {
  type: ErrorType;
  message: string;
  details?: Record<string, any>;
  timestamp: string;
  requestId: string;
}

// Global Error Handler (Express)
export const errorHandler = (
  error: Error,
  req: Request,
  res: Response,
  next: NextFunction
) => {
  const requestId = req.headers['x-request-id'] as string;
  
  // Log error
  logger.error('API Error', {
    error: error.message,
    stack: error.stack,
    requestId,
    url: req.url,
    method: req.method,
  });
  
  // Determine error type and response
  let errorResponse: ErrorResponse;
  
  if (error instanceof ValidationError) {
    errorResponse = {
      type: ErrorType.VALIDATION,
      message: 'Validation failed',
      details: error.details,
      timestamp: new Date().toISOString(),
      requestId,
    };
    res.status(400).json(errorResponse);
  } else if (error instanceof AuthenticationError) {
    errorResponse = {
      type: ErrorType.AUTHENTICATION,
      message: 'Authentication required',
      timestamp: new Date().toISOString(),
      requestId,
    };
    res.status(401).json(errorResponse);
  } else {
    // Default to internal server error
    errorResponse = {
      type: ErrorType.INTERNAL,
      message: 'Internal server error',
      timestamp: new Date().toISOString(),
      requestId,
    };
    res.status(500).json(errorResponse);
  }
};

// Frontend Error Handling
export const handleApiError = (error: any): string => {
  if (error.response?.data?.type) {
    const errorData = error.response.data as ErrorResponse;
    
    switch (errorData.type) {
      case ErrorType.VALIDATION:
        return 'Input validation failed. Please check your data.';
      case ErrorType.AUTHENTICATION:
        return 'Please log in to continue.';
      case ErrorType.AUTHORIZATION:
        return 'You do not have permission to perform this action.';
      case ErrorType.NOT_FOUND:
        return 'The requested resource was not found.';
      case ErrorType.CONFLICT:
        return 'The operation conflicts with the current state.';
      default:
        return 'An unexpected error occurred. Please try again.';
    }
  }
  
  if (error.code === 'NETWORK_ERROR') {
    return 'Network error. Please check your connection.';
  }
  
  return 'An unexpected error occurred. Please try again.';
};
```

ã“ã®è©³ç´°è¨­è¨ˆã«ã‚ˆã‚Šã€å …ç‰¢ã§ä¿å®ˆæ€§ã®é«˜ã„ã‚·ã‚¹ãƒ†ãƒ ãŒæ§‹ç¯‰ã§ãã¾ã™ã€‚
å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒæ˜ç¢ºã«å®šç¾©ã•ã‚Œã€ä¸€è²«ã—ãŸè¨­è¨ˆåŸå‰‡ã«å¾“ã£ã¦ã„ã¾ã™ã€‚
```

### ãƒ•ã‚§ãƒ¼ã‚º2: è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨

#### ã‚¹ãƒ†ãƒƒãƒ—3: é©åˆ‡ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®é¸æŠ

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹:**
```
ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ã«ãŠã„ã¦ã€ä»¥ä¸‹ã®èª²é¡Œã«å¯¾ã—ã¦
é©åˆ‡ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ææ¡ˆã—ã¦ãã ã•ã„ï¼š

èª²é¡Œ:
1. è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®ç®¡ç†
2. ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã®æŠ½è±¡åŒ–
3. é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®æŸ”è»Ÿãªæ‹¡å¼µ
4. UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†åˆ©ç”¨æ€§
5. çŠ¶æ…‹å¤‰æ›´ã®è¿½è·¡ã¨å±¥æ­´ç®¡ç†

å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨ç†ç”±ã¨å®Ÿè£…ä¾‹ã‚‚å«ã‚ã¦ãã ã•ã„ã€‚
```

**Claude Codeã®ãƒ‘ã‚¿ãƒ¼ãƒ³ææ¡ˆä¾‹:**
```
# è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨ææ¡ˆ

## 1. è¤‡é›‘ãªãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ç®¡ç† â†’ Service Layer Pattern

### é©ç”¨ç†ç”±
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‹ã‚‰åˆ†é›¢
- å†åˆ©ç”¨å¯èƒ½ãªãƒ“ã‚¸ãƒã‚¹æ“ä½œã®å®šç¾©
- ãƒ†ã‚¹ãƒˆã®å®¹æ˜“æ€§å‘ä¸Š

### å®Ÿè£…ä¾‹

```typescript
// Business Logic Service
export class TaskService {
  constructor(
    private taskRepository: TaskRepository,
    private userRepository: UserRepository,
    private notificationService: NotificationService
  ) {}

  async assignTask(taskId: string, assigneeId: string, assignedBy: string): Promise<Task> {
    // ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®æ¤œè¨¼
    const task = await this.taskRepository.findById(taskId);
    if (!task) {
      throw new NotFoundError('Task not found');
    }

    const assignee = await this.userRepository.findById(assigneeId);
    if (!assignee || !assignee.isActive) {
      throw new ValidationError('Invalid assignee');
    }

    // æ¨©é™ãƒã‚§ãƒƒã‚¯
    if (!this.canAssignTask(assignedBy, task)) {
      throw new AuthorizationError('Cannot assign this task');
    }

    // ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè¡Œ
    const updatedTask = await this.taskRepository.update(taskId, {
      assignedTo: assigneeId,
      status: TaskStatus.IN_PROGRESS,
      updatedAt: new Date()
    });

    // å‰¯ä½œç”¨ã®å®Ÿè¡Œ
    await this.notificationService.notifyTaskAssigned(updatedTask, assignee);
    
    return updatedTask;
  }

  private canAssignTask(userId: string, task: Task): boolean {
    // æ¨©é™ãƒã‚§ãƒƒã‚¯ãƒ­ã‚¸ãƒƒã‚¯
    return task.createdBy === userId || 
           this.userRepository.hasRole(userId, 'manager');
  }
}
```

## 2. ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã®æŠ½è±¡åŒ– â†’ Repository Pattern

### é©ç”¨ç†ç”±
- ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æŠ½è±¡åŒ–
- ãƒ†ã‚¹ãƒˆæ™‚ã®ãƒ¢ãƒƒã‚¯åŒ–ãŒå®¹æ˜“
- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®å¤‰æ›´ã«å¯¾ã™ã‚‹æŸ”è»Ÿæ€§

### å®Ÿè£…ä¾‹

```typescript
// Repository Interface
export interface TaskRepository {
  findById(id: string): Promise<Task | null>;
  findByAssignee(assigneeId: string): Promise<Task[]>;
  findByProject(projectId: string): Promise<Task[]>;
  create(task: CreateTaskData): Promise<Task>;
  update(id: string, data: UpdateTaskData): Promise<Task>;
  delete(id: string): Promise<void>;
  search(criteria: SearchCriteria): Promise<Task[]>;
}

// Concrete Implementation
export class PrismaTaskRepository implements TaskRepository {
  constructor(private prisma: PrismaClient) {}

  async findById(id: string): Promise<Task | null> {
    const task = await this.prisma.task.findUnique({
      where: { id },
      include: {
        assignedTo: true,
        createdBy: true,
        project: true,
        comments: {
          include: { user: true },
          orderBy: { createdAt: 'desc' }
        }
      }
    });

    return task ? this.mapToTask(task) : null;
  }

  async search(criteria: SearchCriteria): Promise<Task[]> {
    const where: Prisma.TaskWhereInput = {};

    if (criteria.status) {
      where.status = criteria.status;
    }

    if (criteria.assigneeId) {
      where.assignedTo = criteria.assigneeId;
    }

    if (criteria.projectId) {
      where.projectId = criteria.projectId;
    }

    if (criteria.keyword) {
      where.OR = [
        { title: { contains: criteria.keyword, mode: 'insensitive' } },
        { description: { contains: criteria.keyword, mode: 'insensitive' } }
      ];
    }

    const tasks = await this.prisma.task.findMany({
      where,
      include: {
        assignedTo: true,
        createdBy: true,
        project: true
      },
      orderBy: { createdAt: 'desc' },
      skip: criteria.offset,
      take: criteria.limit
    });

    return tasks.map(this.mapToTask);
  }

  private mapToTask(prismaTask: any): Task {
    // Prismaçµæœã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã«ãƒãƒƒãƒ”ãƒ³ã‚°
    return {
      id: prismaTask.id,
      title: prismaTask.title,
      description: prismaTask.description,
      status: prismaTask.status,
      priority: prismaTask.priority,
      dueDate: prismaTask.dueDate,
      assignedTo: prismaTask.assignedTo,
      createdBy: prismaTask.createdBy,
      project: prismaTask.project,
      createdAt: prismaTask.createdAt,
      updatedAt: prismaTask.updatedAt
    };
  }
}

// Test Mock Implementation
export class MockTaskRepository implements TaskRepository {
  private tasks: Map<string, Task> = new Map();

  async findById(id: string): Promise<Task | null> {
    return this.tasks.get(id) || null;
  }

  async create(data: CreateTaskData): Promise<Task> {
    const task: Task = {
      id: generateId(),
      ...data,
      createdAt: new Date(),
      updatedAt: new Date()
    };
    this.tasks.set(task.id, task);
    return task;
  }

  // ãã®ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰å®Ÿè£…...
}
```

## 3. é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã®æŸ”è»Ÿãªæ‹¡å¼µ â†’ Observer Pattern

### é©ç”¨ç†ç”±
- é€šçŸ¥æ–¹æ³•ã®å‹•çš„ãªè¿½åŠ ãƒ»å‰Šé™¤
- ç–çµåˆãªé€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
- æ‹¡å¼µæ€§ã®ç¢ºä¿

### å®Ÿè£…ä¾‹

```typescript
// Observer Interface
export interface TaskObserver {
  onTaskCreated(task: Task): Promise<void>;
  onTaskUpdated(task: Task, changes: Partial<Task>): Promise<void>;
  onTaskAssigned(task: Task, assignee: User): Promise<void>;
  onTaskCompleted(task: Task): Promise<void>;
}

// Concrete Observers
export class EmailNotificationObserver implements TaskObserver {
  constructor(private emailService: EmailService) {}

  async onTaskAssigned(task: Task, assignee: User): Promise<void> {
    await this.emailService.sendEmail({
      to: assignee.email,
      subject: `æ–°ã—ã„ã‚¿ã‚¹ã‚¯ãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¾ã—ãŸ: ${task.title}`,
      template: 'task-assigned',
      data: { task, assignee }
    });
  }

  async onTaskCompleted(task: Task): Promise<void> {
    if (task.createdBy.id !== task.assignedTo?.id) {
      await this.emailService.sendEmail({
        to: task.createdBy.email,
        subject: `ã‚¿ã‚¹ã‚¯ãŒå®Œäº†ã—ã¾ã—ãŸ: ${task.title}`,
        template: 'task-completed',
        data: { task }
      });
    }
  }

  // ãã®ä»–ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼...
}

export class SlackNotificationObserver implements TaskObserver {
  constructor(private slackService: SlackService) {}

  async onTaskCreated(task: Task): Promise<void> {
    if (task.priority === TaskPriority.URGENT) {
      await this.slackService.sendMessage({
        channel: '#urgent-tasks',
        message: `ğŸš¨ ç·Šæ€¥ã‚¿ã‚¹ã‚¯ãŒä½œæˆã•ã‚Œã¾ã—ãŸ: ${task.title}`,
        attachments: [
          {
            title: task.title,
            text: task.description,
            color: 'danger'
          }
        ]
      });
    }
  }

  // ãã®ä»–ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©ãƒ¼...
}

// Subject (Observable)
export class TaskEventPublisher {
  private observers: TaskObserver[] = [];

  addObserver(observer: TaskObserver): void {
    this.observers.push(observer);
  }

  removeObserver(observer: TaskObserver): void {
    const index = this.observers.indexOf(observer);
    if (index > -1) {
      this.observers.splice(index, 1);
    }
  }

  async notifyTaskCreated(task: Task): Promise<void> {
    await Promise.all(
      this.observers.map(observer => 
        observer.onTaskCreated(task).catch(error => 
          console.error('Observer error:', error)
        )
      )
    );
  }

  async notifyTaskAssigned(task: Task, assignee: User): Promise<void> {
    await Promise.all(
      this.observers.map(observer => 
        observer.onTaskAssigned(task, assignee).catch(error => 
          console.error('Observer error:', error)
        )
      )
    );
  }

  // ãã®ä»–ã®é€šçŸ¥ãƒ¡ã‚½ãƒƒãƒ‰...
}

// Usage in Service
export class TaskService {
  constructor(
    private taskRepository: TaskRepository,
    private eventPublisher: TaskEventPublisher
  ) {}

  async createTask(data: CreateTaskData): Promise<Task> {
    const task = await this.taskRepository.create(data);
    
    // ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
    await this.eventPublisher.notifyTaskCreated(task);
    
    return task;
  }
}
```

## 4. UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å†åˆ©ç”¨æ€§ â†’ Compound Component Pattern

### é©ç”¨ç†ç”±
- æŸ”è»Ÿã§å†åˆ©ç”¨å¯èƒ½ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- é–¢å¿ƒã®åˆ†é›¢
- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ã®å‘ä¸Š

### å®Ÿè£…ä¾‹

```typescript
// Compound Component for Task Card
interface TaskCardProps {
  task: Task;
  onUpdate?: (task: Task) => void;
  onDelete?: (taskId: string) => void;
  children: React.ReactNode;
}

interface TaskCardContextValue {
  task: Task;
  onUpdate?: (task: Task) => void;
  onDelete?: (taskId: string) => void;
}

const TaskCardContext = React.createContext<TaskCardContextValue | null>(null);

export const TaskCard: React.FC<TaskCardProps> & {
  Header: typeof TaskCardHeader;
  Body: typeof TaskCardBody;
  Actions: typeof TaskCardActions;
  Status: typeof TaskCardStatus;
} = ({ task, onUpdate, onDelete, children }) => {
  const contextValue = { task, onUpdate, onDelete };

  return (
    <TaskCardContext.Provider value={contextValue}>
      <div className="task-card">
        {children}
      </div>
    </TaskCardContext.Provider>
  );
};

const TaskCardHeader: React.FC<{ children?: React.ReactNode }> = ({ children }) => {
  const context = useContext(TaskCardContext);
  if (!context) throw new Error('TaskCardHeader must be used within TaskCard');

  return (
    <div className="task-card-header">
      <h3>{context.task.title}</h3>
      {children}
    </div>
  );
};

const TaskCardBody: React.FC<{ children?: React.ReactNode }> = ({ children }) => {
  const context = useContext(TaskCardContext);
  if (!context) throw new Error('TaskCardBody must be used within TaskCard');

  return (
    <div className="task-card-body">
      {context.task.description && (
        <p>{context.task.description}</p>
      )}
      {children}
    </div>
  );
};

const TaskCardActions: React.FC<{ children?: React.ReactNode }> = ({ children }) => {
  const context = useContext(TaskCardContext);
  if (!context) throw new Error('TaskCardActions must be used within TaskCard');

  return (
    <div className="task-card-actions">
      {children}
      <button onClick={() => context.onDelete?.(context.task.id)}>
        å‰Šé™¤
      </button>
    </div>
  );
};

const TaskCardStatus: React.FC = () => {
  const context = useContext(TaskCardContext);
  if (!context) throw new Error('TaskCardStatus must be used within TaskCard');

  return (
    <span className={`status status-${context.task.status}`}>
      {context.task.status}
    </span>
  );
};

// Attach sub-components
TaskCard.Header = TaskCardHeader;
TaskCard.Body = TaskCardBody;
TaskCard.Actions = TaskCardActions;
TaskCard.Status = TaskCardStatus;

// Usage
const TaskList: React.FC<{ tasks: Task[] }> = ({ tasks }) => {
  return (
    <div>
      {tasks.map(task => (
        <TaskCard key={task.id} task={task} onUpdate={handleUpdate} onDelete={handleDelete}>
          <TaskCard.Header>
            <TaskCard.Status />
          </TaskCard.Header>
          <TaskCard.Body />
          <TaskCard.Actions>
            <button>ç·¨é›†</button>
          </TaskCard.Actions>
        </TaskCard>
      ))}
    </div>
  );
};
```

## 5. çŠ¶æ…‹å¤‰æ›´ã®è¿½è·¡ã¨å±¥æ­´ç®¡ç† â†’ Command Pattern + Memento Pattern

### é©ç”¨ç†ç”±
- æ“ä½œã®å–ã‚Šæ¶ˆã—ãƒ»ã‚„ã‚Šç›´ã—æ©Ÿèƒ½
- å¤‰æ›´å±¥æ­´ã®è¨˜éŒ²
- æ“ä½œã®å†å®Ÿè¡Œ

### å®Ÿè£…ä¾‹

```typescript
// Command Interface
export interface Command {
  execute(): Promise<void>;
  undo(): Promise<void>;
  getDescription(): string;
}

// Concrete Commands
export class UpdateTaskCommand implements Command {
  private previousState: Partial<Task>;

  constructor(
    private taskId: string,
    private newData: Partial<Task>,
    private taskRepository: TaskRepository
  ) {}

  async execute(): Promise<void> {
    const currentTask = await this.taskRepository.findById(this.taskId);
    if (!currentTask) {
      throw new Error('Task not found');
    }

    // ç¾åœ¨ã®çŠ¶æ…‹ã‚’ä¿å­˜ï¼ˆMementoï¼‰
    this.previousState = {
      title: currentTask.title,
      description: currentTask.description,
      status: currentTask.status,
      priority: currentTask.priority,
      dueDate: currentTask.dueDate,
      assignedTo: currentTask.assignedTo
    };

    // æ›´æ–°å®Ÿè¡Œ
    await this.taskRepository.update(this.taskId, this.newData);
  }

  async undo(): Promise<void> {
    if (!this.previousState) {
      throw new Error('Cannot undo: no previous state');
    }

    await this.taskRepository.update(this.taskId, this.previousState);
  }

  getDescription(): string {
    return `Update task ${this.taskId}`;
  }
}

export class CreateTaskCommand implements Command {
  private createdTaskId?: string;

  constructor(
    private taskData: CreateTaskData,
    private taskRepository: TaskRepository
  ) {}

  async execute(): Promise<void> {
    const task = await this.taskRepository.create(this.taskData);
    this.createdTaskId = task.id;
  }

  async undo(): Promise<void> {
    if (!this.createdTaskId) {
      throw new Error('Cannot undo: task was not created');
    }

    await this.taskRepository.delete(this.createdTaskId);
  }

  getDescription(): string {
    return `Create task: ${this.taskData.title}`;
  }
}

// Command Manager (Invoker)
export class CommandManager {
  private history: Command[] = [];
  private currentIndex = -1;

  async executeCommand(command: Command): Promise<void> {
    try {
      await command.execute();
      
      // å±¥æ­´ã«è¿½åŠ ï¼ˆç¾åœ¨ä½ç½®ä»¥é™ã‚’å‰Šé™¤ï¼‰
      this.history = this.history.slice(0, this.currentIndex + 1);
      this.history.push(command);
      this.currentIndex++;
      
      // å±¥æ­´ã‚µã‚¤ã‚ºåˆ¶é™
      if (this.history.length > 50) {
        this.history.shift();
        this.currentIndex--;
      }
    } catch (error) {
      console.error('Command execution failed:', error);
      throw error;
    }
  }

  async undo(): Promise<void> {
    if (this.currentIndex < 0) {
      throw new Error('Nothing to undo');
    }

    const command = this.history[this.currentIndex];
    await command.undo();
    this.currentIndex--;
  }

  async redo(): Promise<void> {
    if (this.currentIndex >= this.history.length - 1) {
      throw new Error('Nothing to redo');
    }

    this.currentIndex++;
    const command = this.history[this.currentIndex];
    await command.execute();
  }

  canUndo(): boolean {
    return this.currentIndex >= 0;
  }

  canRedo(): boolean {
    return this.currentIndex < this.history.length - 1;
  }

  getHistory(): string[] {
    return this.history.map(command => command.getDescription());
  }
}

// Usage in Service
export class TaskService {
  constructor(
    private taskRepository: TaskRepository,
    private commandManager: CommandManager
  ) {}

  async updateTask(taskId: string, data: Partial<Task>): Promise<void> {
    const command = new UpdateTaskCommand(taskId, data, this.taskRepository);
    await this.commandManager.executeCommand(command);
  }

  async undoLastAction(): Promise<void> {
    await this.commandManager.undo();
  }

  async redoLastAction(): Promise<void> {
    await this.commandManager.redo();
  }
}
```

ã“ã‚Œã‚‰ã®è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã§ã€
ä¿å®ˆæ€§ã€æ‹¡å¼µæ€§ã€ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã™ã€‚
å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ç‰¹å®šã®å•é¡Œã‚’è§£æ±ºã—ã€
ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å“è³ªã‚’é«˜ã‚ã¾ã™ã€‚
```

## è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼ã¨æ¤œè¨¼

### è¨­è¨ˆå“è³ªã®è©•ä¾¡

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹:**
```
ä½œæˆã—ãŸè¨­è¨ˆã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®è¦³ç‚¹ã§å“è³ªè©•ä¾¡ã‚’è¡Œã£ã¦ãã ã•ã„ï¼š

1. SOLIDåŸå‰‡ã®éµå®ˆ
2. è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©åˆ‡ãªé©ç”¨
3. éæ©Ÿèƒ½è¦ä»¶ã®å®Ÿç¾å¯èƒ½æ€§
4. ä¿å®ˆæ€§ãƒ»æ‹¡å¼µæ€§
5. ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§
6. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

æ”¹å–„ã™ã¹ãç‚¹ãŒã‚ã‚Œã°å…·ä½“çš„ãªä¿®æ­£æ¡ˆã‚‚æç¤ºã—ã¦ãã ã•ã„ã€‚
```

### è¨­è¨ˆæ–‡æ›¸ã®ä½œæˆ

**ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¾‹:**
```
ã“ã‚Œã¾ã§ã®è¨­è¨ˆå†…å®¹ã‚’åŸºã«ã€é–‹ç™ºãƒãƒ¼ãƒ å‘ã‘ã®
è¨­è¨ˆæ–‡æ›¸ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

å«ã‚ã‚‹ã¹ãå†…å®¹:
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦å›³
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè¨­è¨ˆ
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ
- APIè¨­è¨ˆ
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ
- éæ©Ÿèƒ½è¦ä»¶ã¸ã®å¯¾å¿œ

é–‹ç™ºè€…ãŒå®Ÿè£…æ™‚ã«å‚ç…§ã—ã‚„ã™ã„å½¢å¼ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚
```

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

AIã¨è¨­è¨ˆã‚’ç†è§£ã—ãŸã‚‰ï¼š

1. **[è¨­è¨ˆåŸå‰‡ç®¡ç†](03-design-principles.md)** - è¨­è¨ˆå“è³ªã®åŸºç›¤ä½œã‚Š
2. **[AIã«ã‚ˆã‚‹è¨­è¨ˆãƒ¬ãƒ“ãƒ¥ãƒ¼](05-ai-design-review.md)** - è¨­è¨ˆå“è³ªã®æ¤œè¨¼
3. **[å˜ä½“ãƒ†ã‚¹ãƒˆ](06-unit-testing.md)** - è¨­è¨ˆã‚’æ¤œè¨¼ã™ã‚‹ãƒ†ã‚¹ãƒˆä½œæˆ

---

**é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ:**
- [AIã¨è¦ä»¶å®šç¾©](01-requirements-with-ai.md) - å‰ã®ãƒ•ã‚§ãƒ¼ã‚º
- [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ](../02-features/project-context.md) - å¤§è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®è¨­è¨ˆ
- [ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼](../02-features/code-review.md) - è¨­è¨ˆå“è³ªã®ç¶™ç¶šçš„æ”¹å–„